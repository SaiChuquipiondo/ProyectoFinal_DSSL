<div class="university-dashboard">
  <app-header></app-header>

  <main class="dashboard-main">
    <div class="content-wrapper">
      <div class="form-container">
        <div class="form-header">
          <h2 class="form-title">Crear Nuevo Usuario</h2>
          <button routerLink="/coordinacion" class="btn-back">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            Volver
          </button>
        </div>

        <form (ngSubmit)="onSubmit()" #userForm="ngForm" class="form-content">
          <div *ngIf="error" class="alert alert-error" role="alert">
            <p>{{ error }}</p>
          </div>

          <div *ngIf="success" class="alert alert-success" role="alert">
            <p>{{ success }}</p>
          </div>

          <!-- Datos Personales -->
          <div class="form-section">
            <h3 class="section-title">Datos Personales</h3>
            <div class="form-grid">
              <div class="form-group span-2">
                <label>Nombres</label>
                <input type="text" [(ngModel)]="formData.nombres" name="nombres" required />
              </div>
              <div class="form-group">
                <label>Apellido Paterno</label>
                <input
                  type="text"
                  [(ngModel)]="formData.apellido_paterno"
                  name="apellido_paterno"
                  required
                />
              </div>
              <div class="form-group">
                <label>Apellido Materno</label>
                <input
                  type="text"
                  [(ngModel)]="formData.apellido_materno"
                  name="apellido_materno"
                />
              </div>
              <div class="form-group">
                <label>DNI</label>
                <input
                  type="text"
                  [(ngModel)]="formData.dni"
                  name="dni"
                  required
                  pattern="[0-9]{8}"
                  maxlength="8"
                />
              </div>
              <div class="form-group">
                <label>Celular</label>
                <input type="tel" [(ngModel)]="formData.celular" name="celular" />
              </div>
              <div class="form-group">
                <label>Fecha de Nacimiento</label>
                <input
                  type="date"
                  [(ngModel)]="formData.fecha_nacimiento"
                  name="fecha_nacimiento"
                />
              </div>
              <div class="form-group">
                <label>Sexo</label>
                <select [(ngModel)]="formData.sexo" name="sexo" class="form-select">
                  <option value="M">Masculino</option>
                  <option value="F">Femenino</option>
                </select>
              </div>
              <div class="form-group span-2">
                <label>Correo Electrónico</label>
                <input type="email" [(ngModel)]="formData.correo" name="correo" />
              </div>
              <div class="form-group span-2">
                <label>Dirección</label>
                <input type="text" [(ngModel)]="formData.direccion" name="direccion" />
              </div>
            </div>
          </div>

          <!-- Datos de Cuenta -->
          <div class="form-section">
            <h3 class="section-title">Datos de Cuenta</h3>
            <div class="form-grid">
              <div class="form-group">
                <label>Usuario</label>
                <input type="text" [(ngModel)]="formData.username" name="username" required />
              </div>
              <div class="form-group">
                <label>Contraseña</label>
                <input type="password" [(ngModel)]="formData.password" name="password" required />
              </div>
            </div>
          </div>

          <!-- Rol y Específicos -->
          <div class="form-section">
            <h3 class="section-title">Tipo de Usuario</h3>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="rol" value="ESTUDIANTE" [(ngModel)]="formData.rol" />
                <span>Estudiante</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="rol" value="DOCENTE" [(ngModel)]="formData.rol" />
                <span>Docente</span>
              </label>
            </div>

            <div *ngIf="formData.rol === 'ESTUDIANTE'" class="form-grid mt-4">
              <div class="form-group">
                <label>Código Universitario</label>
                <input
                  type="text"
                  [(ngModel)]="formData.codigo_estudiante"
                  name="codigo_estudiante"
                  required
                />
              </div>
              <div class="form-group">
                <label>Fecha de Egreso</label>
                <input type="date" [(ngModel)]="formData.fecha_egreso" name="fecha_egreso" />
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" routerLink="/coordinacion" class="btn-cancel">Cancelar</button>
            <button type="submit" [disabled]="!userForm.form.valid || loading" class="btn-submit">
              <span *ngIf="loading" class="spinner-sm"></span>
              {{ loading ? 'Guardando...' : 'Crear Usuario' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>
